<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Your Presence Is Your Power | Executive Presence E-Book by Kathryn Ficarra</title>
    <link rel="icon" type="image/webp" href="images/cgroup-logo.webp">
    
    <!-- Meta Pixel Code -->
    <script>
    !function(f,b,e,v,n,t,s)
    {if(f.fbq)return;n=f.fbq=function(){n.callMethod?
    n.callMethod.apply(n,arguments):n.queue.push(arguments)};
    if(!f._fbq)f._fbq=n;n.push=n;n.loaded=!0;n.version='2.0';
    n.queue=[];t=b.createElement(e);t.async=!0;
    t.src=v;s=b.getElementsByTagName(e)[0];
    s.parentNode.insertBefore(t,s)}(window, document,'script',
    'https://connect.facebook.net/en_US/fbevents.js');
    fbq('init', '1607445923276301');
    fbq('track', 'PageView');
    </script>
    <noscript><img height="1" width="1" style="display:none"
    src="https://www.facebook.com/tr?id=1607445923276301&ev=PageView&noscript=1"
    /></noscript>
    <!-- End Meta Pixel Code -->
    
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;700&family=Raleway:wght@300;400;500;600;700&display=swap">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
    <style>
        /* Smooth scrolling */
        html {
            scroll-behavior: smooth;
        }
        
        :root {
            /* Brand Colors */
            --primary-color: #ff0004;    /* Keeping existing red for brand consistency */
            --primary-hover: #d10003;    /* Slightly darker red for hover states */
            --secondary-color: #1e40af;   /* Deep blue for accents */
            --secondary-hover: #1e3a8a;  /* Darker blue for hover states */
            
            /* Background Colors */
            --bg-primary: #f8fafc;       /* Light sections */
            --bg-secondary: #ffffff;     /* Content areas */
            --bg-accent: #f1f5f9;        /* Subtle accent backgrounds */
            
            /* Text Colors */
            --text-primary: #1f2937;     /* Dark gray for primary text */
            --text-secondary: #4b5563;   /* Medium gray for secondary text */
            --text-light: #6b7280;       /* Light gray for tertiary text */
            
            /* UI Colors */
            --border-color: #e5e7eb;     /* Light gray for borders */
            --success-color: #10b981;    /* Green for success messages */
            --error-color: #ef4444;      /* Red for errors */
            --warning-color: #f59e0b;    /* Yellow for warnings */
            --info-color: #3b82f6;       /* Blue for info messages */
            
            /* Transitions */
            --transition: all 0.3s ease;
            --transition-slow: all 0.5s ease;
            --transition-fast: all 0.15s ease;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        /* Base Typography */
        body {
            font-family: 'Raleway', sans-serif;
            line-height: 1.8;
            letter-spacing: 0.3px;
            color: var(--text-primary);
            background-color: var(--bg-primary);
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }
        
        h1, h2, h3, h4 {
            letter-spacing: -0.5px;
            line-height: 1.3;
            margin-bottom: 1.5rem;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
        }
        
        header {
            background-color: #fff;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            padding: 20px 0;
        }
        
        .header-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .logo {
            display: flex;
            align-items: center;
        }
        
        .logo img {
            height: 50px;  /* Increased from 40px */
            width: auto;
        }
        
        /* Section backgrounds */
        /* Section Backgrounds */
        .hero, .chapter-preview, .author-section, footer {
            background-color: var(--bg-primary);
            position: relative;
            overflow: hidden;
            border-bottom: 1px solid var(--border-color);
        }
        
        /* Add subtle pattern to alternate sections */
        .hero::after, .chapter-preview::after, .author-section::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-image: radial-gradient(circle at 1px 1px, rgba(0, 0, 0, 0.03) 1px, transparent 0);
            background-size: 20px 20px;
            opacity: 0.5;
            pointer-events: none;
        }
        
        .ebook-preview, .whats-inside, .form-section {
            background-color: var(--bg-secondary);
            position: relative;
            border-bottom: 1px solid var(--border-color);
        }
        
        /* Section spacing */
        section {
            padding: 6rem 0;
        }
        
        /* Hero Section */
        .hero {
            padding: 6rem 0;
            position: relative;
            background: linear-gradient(135deg, #f8fafc 0%, #f1f5f9 100%);
            overflow: hidden;
        }
        
        .hero::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: radial-gradient(circle at 20% 30%, rgba(255, 0, 4, 0.03) 0%, transparent 50%);
            pointer-events: none;
        }
        
        .hero-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 4rem;
            align-items: center;
            max-width: 1200px;
            margin: 0 auto;
        }
        
        .hero-content {
            padding: 2rem 0;
        }
        
        .hero h1 {
            font-family: 'Playfair Display', serif;
            font-size: 3.25rem;
            margin-bottom: 1.5rem;
            color: #1a1a2e;
            font-weight: 800;
            line-height: 1.15;
            letter-spacing: -0.5px;
        }
        
        .hero h1 .highlight {
            color: var(--primary-color);
            position: relative;
            display: inline-block;
        }
        
        .hero h1 .highlight::after {
            content: '';
            position: absolute;
            left: 0;
            bottom: 5px;
            width: 100%;
            height: 12px;
            background-color: rgba(255, 0, 4, 0.15);
            z-index: -1;
            border-radius: 3px;
        }
        
        .hero h2 {
            font-size: 1.4rem;
            font-weight: 400;
            margin-bottom: 2.5rem;
            color: #4a5568;
            line-height: 1.6;
            max-width: 600px;
        }
        
        .cta-wrapper {
            display: flex;
            flex-direction: column;
            gap: 1rem;
            margin-top: 2.5rem;
        }
        
        .btn {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            background-color: var(--primary-color);
            color: white;
            padding: 1rem 2.5rem;
            border-radius: 50px;
            text-decoration: none;
            font-weight: 600;
            font-size: 1.1rem;
            transition: all 0.3s ease;
            border: none;
            cursor: pointer;
            box-shadow: 0 4px 15px rgba(255, 0, 4, 0.3);
            max-width: 300px;
        }
        
        .btn i {
            margin-left: 10px;
            transition: transform 0.3s ease;
        }
        
        .btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 20px rgba(255, 0, 4, 0.4);
        }
        
        .btn:hover i {
            transform: translateX(5px);
        }
        
        .trust-badge {
            display: flex;
            align-items: center;
            font-size: 0.9rem;
            color: #718096;
        }
        
        .trust-badge i {
            margin-right: 8px;
            color: #48bb78;
        }
        
        .hero-image {
            position: relative;
            text-align: center;
        }
        
        .ebook-cover {
            max-width: 100%;
            height: auto;
            border-radius: 8px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.15);
            transition: transform 0.3s ease;
        }
        
        .hero-image:hover .ebook-cover {
            transform: translateY(-5px);
        }
        
        .bestseller-badge {
            position: absolute;
            top: -15px;
            right: -15px;
            background: #ffd700;
            color: #8b6914;
            padding: 8px 16px;
            border-radius: 50px;
            font-size: 0.9rem;
            font-weight: 600;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .bestseller-badge i {
            color: #ffd700;
            text-shadow: 0 0 1px #8b6914;
        }
        
        @media (max-width: 992px) {
            .hero-grid {
                grid-template-columns: 1fr;
                gap: 2rem;
                text-align: center;
            }
            
            .hero h2,
            .cta-wrapper {
                margin-left: auto;
                margin-right: auto;
            }
            
            .hero-image {
                order: -1;
                max-width: 400px;
                margin: 0 auto;
            }
            
            .bestseller-badge {
                right: 0;
                left: 0;
                margin: 0 auto;
                width: max-content;
            }
        }
        
        @media (max-width: 576px) {
            .hero h1 {
                font-size: 2.5rem;
            }
            
            .hero h2 {
                font-size: 1.2rem;
            }
            
            .btn {
                width: 100%;
                max-width: none;
            }
        }
        
        .ebook-preview {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin: 60px 0;
            flex-wrap: wrap;
        }
        
        .preview-content {
            flex: 1;
            padding: 0 20px;
            min-width: 300px;
        }
        
        .preview-image {
            flex: 1;
            padding: 0 20px;
            text-align: center;
            min-width: 300px;
        }
        
        .preview-image img {
            max-width: 100%;
            box-shadow: 0 15px 30px rgba(0,0,0,0.2);
            border-radius: 5px;
        }
        
        .chapter-preview {
            background-color: var(--accent-color);
            padding: 60px 0;
        }
        
        .chapter-content {
            max-width: 800px;
            margin: 0 auto;
        }
        
        .chapter-content h3 {
            font-family: 'Playfair Display', serif;
            font-size: 28px;
            margin-bottom: 20px;
            color: var(--primary-color);
        }
        
        .chapter-content p {
            margin-bottom: 20px;
            font-size: 18px;
        }
        
        .form-section {
            padding: 80px 0;
            text-align: center;
            background-color: #fff;
        }
        
        .form-container {
            max-width: 600px;
            margin: 0 auto;
            padding: 40px;
            background-color: #fff;
            border-radius: 10px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
        }
        
        .form-container h3 {
            font-family: 'Playfair Display', serif;
            font-size: 28px;
            margin-bottom: 20px;
        }
        
        .form-container p {
            margin-bottom: 30px;
            font-size: 18px;
        }
        
        .form-group {
            margin-bottom: 20px;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            text-align: left;
        }
        
        .form-group input {
            width: 100%;
            padding: 12px 15px;
            border: 1px solid #ddd;
            border-radius: 5px;
            font-size: 16px;
            transition: border 0.3s;
        }
        
        .form-group input:focus {
            border-color: var(--secondary-color);
            outline: none;
        }
        
        /* Buttons */
        /* Buttons */
        .btn {
            display: inline-block;
            background-color: var(--primary-color);
            color: white;
            padding: 0.875rem 2rem;
            border: 2px solid transparent;
            border-radius: 50px;
            font-size: 1.1rem;
            font-weight: 600;
            line-height: 1.5;
            text-align: center;
            text-decoration: none;
            cursor: pointer;
            transition: var(--transition);
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
            position: relative;
            overflow: hidden;
            -webkit-font-smoothing: antialiased;
        }
        
        .btn::after {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 5px;
            height: 5px;
            background: rgba(255, 255, 255, 0.5);
            opacity: 0;
            border-radius: 100%;
            transform: scale(1, 1) translate(-50%);
            transform-origin: 50% 50%;
        }
        
        .btn:focus:not(:active)::after {
            animation: ripple 1s ease-out;
        }
        
        @keyframes ripple {
            0% {
                transform: scale(0, 0);
                opacity: 0.5;
            }
            100% {
                transform: scale(20, 20);
                opacity: 0;
            }
        }
        
        .btn:hover {
            background-color: var(--primary-hover);
            transform: translateY(-2px);
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
        }
        
        .btn:active {
            transform: translateY(1px);
            box-shadow: 0 1px 2px 0 rgba(0, 0, 0, 0.05);
        }
        
        .btn-secondary {
            background-color: var(--secondary-color);
        }
        
        .btn-secondary:hover {
            background-color: #3558c4;
        }
        
        .whats-inside {
            padding: 60px 0;
        }
        
        .whats-inside h3 {
            font-family: 'Playfair Display', serif;
            font-size: 32px;
            margin-bottom: 40px;
            text-align: center;
        }
        
        .chapters-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 30px;
        }
        
        /* Cards */
        /* Cards */
        .chapter-card {
            background: var(--bg-secondary);
            border-radius: 12px;
            padding: 2.25rem;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.05), 0 2px 4px -1px rgba(0, 0, 0, 0.03);
            transition: var(--transition);
            height: 100%;
            position: relative;
            overflow: hidden;
            border: 1px solid var(--border-color);
            transition: transform 0.3s ease, box-shadow 0.3s ease, border-color 0.3s ease;
        }
        
        .chapter-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 4px;
            height: 0;
            background: var(--secondary-color);
            background: linear-gradient(to bottom, var(--secondary-color), var(--primary-color));
            transition: var(--transition);
            z-index: 1;
        }
        
        .chapter-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 30px rgba(0,0,0,0.1);
        }
        
        .chapter-card:hover::before {
            height: 100%;
        }
        
        .chapter-card h4 {
            font-family: 'Playfair Display', serif;
            font-size: 22px;
            margin-bottom: 15px;
            color: var(--secondary-color);
        }
        
        .chapter-card p {
            margin-bottom: 0;
        }
        
        .author-section {
            padding: 60px 0;
            background-color: var(--accent-color);
        }
        
        .author-content {
            display: flex;
            align-items: center;
            flex-wrap: wrap;
        }
        
        .author-image {
            flex: 1;
            padding: 0 20px;
            text-align: center;
            min-width: 300px;
        }
        
        .author-image img {
            max-width: 300px;
            border-radius: 50%;
            box-shadow: 0 10px 20px rgba(0,0,0,0.1);
        }
        
        .author-bio {
            flex: 2;
            padding: 0 20px;
            min-width: 300px;
        }
        
        .author-bio h3 {
            font-family: 'Playfair Display', serif;
            font-size: 28px;
            margin-bottom: 20px;
        }
        
        footer {
            background-color: var(--dark-color);
            color: #fff;
            padding: 40px 0;
            text-align: center;
        }
        
        .footer-content p {
            margin-bottom: 20px;
        }
        
        .privacy-text {
            font-size: 14px;
            color: #aaa;
            max-width: 800px;
            margin: 0 auto;
        }
        
        /* Animations */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .hero-content, .chapter-content, .whats-inside > .container {
            animation: fadeIn 0.8s ease-out;
        }
        
        /* Back to top button */
        .back-to-top {
            position: fixed;
            bottom: 2rem;
            right: 2rem;
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background: var(--primary-color);
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            text-decoration: none;
            box-shadow: 0 4px 10px rgba(0,0,0,0.1);
            opacity: 0;
            visibility: hidden;
            transition: var(--transition);
            z-index: 999;
        }
        
        .back-to-top.visible {
            opacity: 1;
            visibility: visible;
        }
        
        .back-to-top:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 15px rgba(0,0,0,0.15);
        }
        
        /* Responsive Design */
        @media (max-width: 768px) {
            html {
                font-size: 90%;
            }
            
            section {
                padding: 4rem 0;
            }
            
            .hero {
                padding: 5rem 0;
            }
            
            .hero h1 {
                font-size: 2.5rem;
            }
            
            .hero h2 {
                font-size: 1.25rem;
                padding: 0 1rem;
            }
            
            .ebook-preview {
                flex-direction: column;
            }
            
            .preview-content, .preview-image {
                padding: 1.5rem 0;
            }
            
            .author-content {
                flex-direction: column;
                text-align: center;
            }
            
            .author-image, .author-bio {
                padding: 1.5rem 0;
            }
            
            .back-to-top {
                width: 45px;
                height: 45px;
                bottom: 1.5rem;
                right: 1.5rem;
            }
        }
    </style>
</head>
<body>
    <header>
        <div class="container">
            <div class="header-content">
                <div class="logo">
                    <img src="images/cgroup-logo.webp" alt="The C Group Studio">
                </div>
            </div>
        </div>
    </header>

    <section class="hero">
        <div class="container">
            <div class="hero-grid">
                <div class="hero-content">
                    <h1>Your Presence Is <span class="highlight">Your Power</span></h1>
                    <h2>Unlock Your Authentic Leadership Presence and Command Respect in Every Room</h2>
                    <div class="cta-wrapper">
                        <a href="#get-ebook" class="btn">Get Your Free E-Book <i class="fas fa-arrow-right"></i></a>
                        <p class="trust-badge"><i class="fas fa-shield-alt"></i> Secure download. No spam. Unsubscribe anytime.</p>
                    </div>
                </div>
                <div class="hero-image">
                    <img src="images/ebook-cover.png" alt="Your Presence Is Your Power - Ebook Cover" class="ebook-cover">
                    <div class="bestseller-badge">
                        <i class="fas fa-star"></i> Free Executive Gift
                    </div>
                </div>
            </div>
        </div>
    </section>

    <section class="ebook-preview">
        <div class="container">
            <div class="preview-content">
                <h2 class="section-title">Transform Your Leadership Presence</h2>
                <p>Discover the six internal shifts that transformed Kathryn Ficarra's leadership journey and hundreds of executives she's coached. This isn't just another leadership manual—it's your roadmap to authentic executive presence.</p>
                
                <h4 class="benefits-heading">In this guide, you'll unlock the power to:</h4>
                <ul class="benefits-list">
                    <li><i class="fas fa-bullseye"></i> <span>Align your identity with leadership for authentic, magnetic presence</span></li>
                    <li><i class="fas fa-brain"></i> <span>Master your mindset to project unshakable confidence</span></li>
                    <li><i class="fas fa-user-tie"></i> <span>Embody your leadership persona naturally and effectively</span></li>
                    <li><i class="fas fa-fire"></i> <span>Activate your inner authority to command respect effortlessly</span></li>
                    <li><i class="fas fa-comments"></i> <span>Communicate with clarity that inspires action and loyalty</span></li>
                    <li><i class="fas fa-chart-line"></i> <span>Evolve into your highest leadership potential with proven strategies</span></li>
                </ul>
                <p class="cta-text">Your journey to transformative executive presence starts here.</p>
            </div>
        </div>
    </section>

    <section class="chapter-preview">
        <div class="container">
            <div class="chapter-content">
                <h3>From the Book: Identity & Alignment</h3>
                <p>"Before you can lead others with presence, you have to know who you are when no one is watching."</p>
                <p>We spend so much of our professional lives trying to become what others expect—the competent one, the strong one, the fixer, the closer, the team player. And somewhere along the way, we lose track of ourselves.</p>
                <p>We trade authenticity for approval. Power for performance. Presence for perfection.</p>
                <p>But executive presence isn't about image. It's about alignment. It's about what happens internally before you ever say a word.</p>
            </div>
        </div>
    </section>

    <section class="whats-inside">
        <div class="container">
            <h3>What's Inside the E-Book</h3>
            <div class="chapters-grid">
                <div class="chapter-card">
                    <h4>Chapter 1: Identity & Alignment</h4>
                    <p>Discover how to lead from your truth, not your title, and create alignment between who you are and how you lead. Includes the IMPACT framework for nervous system alignment.</p>
                </div>
                <div class="chapter-card">
                    <h4>Chapter 2: Mindset Mastery</h4>
                    <p>Learn how to rewire limiting beliefs and master the Belief Loop that shapes your leadership presence and decision-making.</p>
                </div>
                <div class="chapter-card">
                    <h4>Chapter 3: Persona Embodiment</h4>
                    <p>Move beyond performance to truly embody your leadership through practical visualization and micro-shift techniques.</p>
                </div>
                <div class="chapter-card">
                    <h4>Chapter 4: Authority Activation</h4>
                    <p>Develop unshakable presence through the Aligned Yes / Empowered No framework and learn to lead from your nervous system's wisdom.</p>
                </div>
                <div class="chapter-card">
                    <h4>Chapter 5: Communication Excellence</h4>
                    <p>Master the "Own the Room in 30 Seconds" framework for clear, confident communication that lands with impact.</p>
                </div>
                <div class="chapter-card">
                    <h4>Chapter 6: Transformative Growth</h4>
                    <p>Implement the 90-Day Presence Tracker to turn insights into embodied leadership that transforms how you show up in every area of life.</p>
                </div>
            </div>
        </div>
    </section>

    <section class="author-section">
        <div class="container">
            <div class="author-content">
                <div class="author-image">
                    <img src="images/kathryn-ficarra.jpg" alt="Kathryn Ficarra" onerror="this.remove()">
                </div>
                <div class="author-bio">
                    <h3>About Kathryn Ficarra</h3>
                    <p>For over 20 years, Kathryn was a high-achieving executive, leading teams across industries, collecting titles and checking all the boxes. But inside, she was disconnected.</p>
                    <p>After her own transformative journey, Kathryn now coaches executives and leaders to develop authentic presence that comes from alignment, not performance.</p>
                    <p>Her Executive Presence Immersion experience has helped hundreds of leaders transform how they show up, lead, and live—creating impact that extends far beyond the boardroom.</p>
                </div>
            </div>
        </div>
    </section>

    <section id="get-ebook" class="form-section">
        <div class="container">
            <div class="form-container">
                <h3>Get Your Free E-Book</h3>
                <p>Enter your details below to receive "Your Presence Is Your Power" delivered straight to your inbox.</p>
                <form id="ebook-form" action="thank-you-ebook.html" method="get">
                    <div class="form-group">
                        <label for="first-name">First Name</label>
                        <input type="text" id="first-name" name="first-name" required>
                    </div>
                    <div class="form-group">
                        <label for="email">Email Address</label>
                        <input type="email" id="email" name="email" required>
                    </div>
                    <button type="submit" class="btn btn-secondary">Download Now</button>
                </form>
            </div>
        </div>
    </section>

    <footer>
        <div class="container">
            <div class="footer-content">
                <p>&copy; 2025 The Cgroup Studio. All rights reserved.</p>
                <p class="privacy-text">By submitting this form, you agree to receive emails from The Cgroup Studio. Your information will never be shared with third parties. You can unsubscribe at any time.</p>
            </div>
        </div>
    </footer>

    <script>
        // Function to get URL parameters
        function getUrlParameter(name) {
            name = name.replace(/[\[]/, '\\[').replace(/[\]]/, '\\]');
            const regex = new RegExp('[\\?&]' + name + '=([^&#]*)');
            const results = regex.exec(location.search);
            return results === null ? '' : decodeURIComponent(results[1].replace(/\+/g, ' '));
        }

        document.getElementById('ebook-form').addEventListener('submit', async function(e) {
            e.preventDefault();
            
            const firstName = document.getElementById('first-name').value;
            const email = document.getElementById('email').value;
            const submitButton = this.querySelector('button[type="submit"]');
            const originalButtonText = submitButton.innerHTML;
            
            try {
                // Show loading state
                submitButton.disabled = true;
                submitButton.innerHTML = 'Sending...';
                
                // Prepare UTM parameters
                const utmSource = getUrlParameter('utm_source') || 'ebook-funnel';
                const utmMedium = getUrlParameter('utm_medium') || 'organic';
                const utmCampaign = getUrlParameter('utm_campaign') || 'executive-presence-ebook';
                
                // Prepare custom fields
                const customFields = {
                    'First Name': firstName,
                    'UTM Source': utmSource,
                    'UTM Medium': utmMedium,
                    'UTM Campaign': utmCampaign,
                    'Lead Source': 'Website',
                    'Status': 'New Lead',
                    'Signup Page': 'Executive Presence Ebook'
                };

                // Send to Flodesk
                const response = await fetch('https://api.flodesk.com/v1/subscribers', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'Authorization': 'Basic ' + btoa('fd_key_a5671a146595472fb913e1ef30126273.HLXll0SLiOy4OEnKoLQM6zujCjbxVlXpGWxcQHKUKC9ecFHBrE72BtMEYRa60MZvu5vj0hJqeTKsEEHbPDi4VdSSXxSsQ6lZM1byw0EHymimmm2fH1KfGLHbUcYXNMB0ijLLMij3ZiPrdFJkth0xlLF9Hhlj5Whpgcua1SQnw7UdNW0Gp2WqPU53Ryn185DM:'),
                        'User-Agent': 'ExecutivePresenceEbook/1.0'
                    },
                    body: JSON.stringify({
                        email: email,
                        first_name: firstName,
                        custom_fields: customFields,
                        tags: ['executive-presence-ebook', 'lead'],
                        status: 'active',
                        double_opt_in: false
                    })
                });

                if (!response.ok) {
                    throw new Error(`Flowdesk API error: ${response.status}`);
                }

                // On success, redirect to thank you page with parameters
                const url = new URL('thank-you-ebook.html', window.location.origin);
                url.searchParams.set('name', encodeURIComponent(firstName));
                url.searchParams.set('email', encodeURIComponent(email));
                
                // Add UTM parameters
                ['source', 'medium', 'campaign', 'term', 'content'].forEach(param => {
                    const value = getUrlParameter('utm_' + param);
                    if (value) url.searchParams.set('utm_' + param, value);
                });
                
                window.location.href = url.toString();
                
            } catch (error) {
                console.error('Error submitting form to Flowdesk:', error);
                alert('There was an error submitting the form. Please try again or contact support if the problem persists.');
                submitButton.disabled = false;
                submitButton.innerHTML = originalButtonText;
            }
        });
    </script>
    
    <!-- Flodesk Tools (Remove in production) -->
    <div style="position: fixed; bottom: 20px; right: 20px; z-index: 1000; background: white; padding: 15px; border-radius: 8px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); width: 350px; max-width: 90vw;">
        <h3 style="margin-top: 0; margin-bottom: 15px; display: flex; justify-content: space-between; align-items: center;">
            <span>Flodesk Tools</span>
            <button id="toggleToolsBtn" style="background: none; border: none; cursor: pointer; font-size: 16px;">▼</button>
        </h3>
        
        <div id="toolsContent" style="display: block;">
            <!-- Segment Creation -->
            <div style="margin-bottom: 15px; border: 1px solid #e9ecef; padding: 10px; border-radius: 4px;">
                <h4 style="margin-top: 0; margin-bottom: 8px;">Create Segment</h4>
                <input type="text" id="segmentName" placeholder="Segment Name" style="width: 100%; padding: 6px; margin-bottom: 8px; border: 1px solid #ced4da; border-radius: 4px;">
                <!-- Color selection removed - Flodesk will assign a default color -->
                <div style="margin-bottom: 8px;">
                    <label style="display: block; margin-bottom: 4px; font-size: 12px;">Rule:</label>
                    <div style="display: flex; gap: 5px; margin-bottom: 5px;">
                        <select id="ruleField" style="flex: 2; padding: 4px;">
                            <option value="custom_fields.lead_source">Lead Source</option>
                            <option value="custom_fields.signup_page">Signup Page</option>
                            <option value="tags">Tags</option>
                        </select>
                        <select id="ruleOperator" style="flex: 1; padding: 4px;">
                            <option value="contains">contains</option>
                            <option value="equals">equals</option>
                            <option value="starts_with">starts with</option>
                            <option value="ends_with">ends with</option>
                        </select>
                    </div>
                    <input type="text" id="ruleValue" placeholder="Value" style="width: 100%; padding: 6px; border: 1px solid #ced4da; border-radius: 4px;">
                </div>
                <button id="createSegmentBtn" style="width: 100%; padding: 6px; background: #6c757d; color: white; border: none; border-radius: 4px; cursor: pointer;">
                    Create Segment
                </button>
            </div>
            
            <div style="margin-bottom: 10px;">
                <div style="display: flex; gap: 10px; margin-bottom: 10px;">
                    <button id="testFlodeskBtn" style="padding: 8px 12px; background: #ff4444; color: white; border: none; border-radius: 4px; cursor: pointer; flex: 1;">
                        Test Integration
                    </button>
                    <button id="listWorkflowsBtn" style="padding: 8px 12px; background: #4CAF50; color: white; border: none; border-radius: 4px; cursor: pointer; flex: 1;">
                        List Workflows
                    </button>
                    <button id="listSegmentsBtn" style="padding: 8px 12px; background: #9C27B0; color: white; border: none; border-radius: 4px; cursor: pointer; flex: 1; margin-top: 5px;">
                        List Segments
                    </button>
                </div>
                <div style="margin-top: 8px;">
                    <input type="text" id="segmentId" placeholder="Segment ID (optional)" style="width: 100%; padding: 6px; border: 1px solid #ced4da; border-radius: 4px; font-size: 12px;">
                </div>
            </div>
        </div>
        
        <div id="testResult" style="margin-top: 10px; padding: 10px; border-radius: 4px; display: none; max-height: 200px; overflow-y: auto; background: #f8f9fa; font-size: 13px; line-height: 1.4;"></div>
        <pre id="workflowsList" style="margin-top: 10px; padding: 10px; border-radius: 4px; background: #f8f9fa; display: none; max-height: 300px; overflow-y: auto; white-space: pre-wrap; font-size: 12px;"></pre>
    </div>
    
    <script>
        // Toggle tools panel
        document.getElementById('toggleToolsBtn').addEventListener('click', function() {
            const content = document.getElementById('toolsContent');
            content.style.display = content.style.display === 'none' ? 'block' : 'none';
            this.textContent = content.style.display === 'none' ? '▶' : '▼';
        });

        // Helper function to show messages
        function showMessage(elementId, message, isError = false) {
            const element = document.getElementById(elementId);
            element.textContent = message;
            element.style.display = 'block';
            element.style.background = isError ? '#f8d7da' : '#d4edda';
            element.style.color = isError ? '#721c24' : '#155724';
            element.style.padding = '10px';
            element.style.borderRadius = '4px';
            element.style.marginTop = '10px';
        }

        // List all Segments
        document.getElementById('listSegmentsBtn').addEventListener('click', async function() {
            const resultDiv = document.getElementById('testResult');
            resultDiv.innerHTML = 'Fetching segments...';
            resultDiv.style.display = 'block';
            resultDiv.style.background = '#fff3cd';
            
            try {
                const response = await fetch('https://api.flodesk.com/v1/segments', {
                    headers: {
                        'Authorization': 'Basic ' + btoa('fd_key_a5671a146595472fb913e1ef30126273.HLXll0SLiOy4OEnKoLQM6zujCjbxVlXpGWxcQHKUKC9ecFHBrE72BtMEYRa60MZvu5vj0hJqeTKsEEHbPDi4VdSSXxSsQ6lZM1byw0EHymimmm2fH1KfGLHbUcYXNMB0ijLLMij3ZiPrdFJkth0xlLF9Hhlj5Whpgcua1SQnw7UdNW0Gp2WqPU53Ryn185DM:'),
                        'User-Agent': 'ExecutivePresenceEbook/1.0'
                    }
                });
                
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
                
                const data = await response.json();
                console.log('Segments:', data);
                
                if (data && data.data && data.data.length > 0) {
                    let html = '<h4>Your Segments:</h4><div style="max-height: 300px; overflow-y: auto; border: 1px solid #ddd; padding: 10px; margin-top: 5px; background: white;">';
                    
                    data.data.forEach(segment => {
                        const isEbookSegment = segment.name && segment.name.includes('Your Presence Is Your Power Ebook');
                        const segmentStyle = isEbookSegment ? 'background: #e8f5e9; padding: 8px; border-left: 4px solid #4CAF50; margin: 5px 0;' : 'padding: 8px; border-left: 4px solid #e0e0e0; margin: 5px 0;';
                        const colorBox = segment.color ? `<span style="display: inline-block; width: 12px; height: 12px; background: ${segment.color}; margin-right: 6px; vertical-align: middle; border-radius: 2px;"></span>` : '';
                        
                        html += `
                            <div style="${segmentStyle}">
                                ${colorBox}<strong>${segment.name || 'Unnamed Segment'}</strong><br>
                                <small>ID: <code>${segment.id}</code> • ${segment.total_active_subscribers || 0} active subscribers • Created: ${new Date(segment.created_at).toLocaleDateString()}</small>
                                ${isEbookSegment ? '<div style="color: #2e7d32; font-size: 12px; margin-top: 3px;">✓ This appears to be your Ebook segment</div>' : ''}
                            </div>`;
                    });
                    
                    // Add pagination info if available
                    if (data.meta) {
                        html += `
                            <div style="margin-top: 10px; padding-top: 10px; border-top: 1px solid #eee; font-size: 12px; color: #666;">
                                Page ${data.meta.page + 1} of ${data.meta.total_pages} • 
                                ${data.meta.total_items} total segments
                            </div>`;
                    }
                    
                    html += '</div><p style="margin-top: 8px; font-size: 12px; color: #666;">Copy the Segment ID to use in the Test Integration above.</p>';
                    resultDiv.innerHTML = html;
                } else {
                    resultDiv.innerHTML = 'No segments found in your Flodesk account.';
                }
                
                resultDiv.style.background = '#e7f5fe';
            } catch (error) {
                console.error('Error fetching segments:', error);
                resultDiv.innerHTML = `❌ Error fetching segments: ${error.message || 'Unknown error'}`;
                resultDiv.style.background = '#ffebee';
            }
        });

        // List Flodesk Workflows
        document.getElementById('listWorkflowsBtn').addEventListener('click', async function() {
            const resultDiv = document.getElementById('workflowsList');
            const testResult = document.getElementById('testResult');
            
            try {
                testResult.textContent = 'Fetching workflows...';
                testResult.style.display = 'block';
                
                const response = await fetch('https://api.flodesk.com/v1/workflows', {
                    method: 'GET',
                    headers: {
                        'Content-Type': 'application/json',
                        'Authorization': 'Basic ' + btoa('fd_key_a5671a146595472fb913e1ef30126273.HLXll0SLiOy4OEnKoLQM6zujCjbxVlXpGWxcQHKUKC9ecFHBrE72BtMEYRa60MZvu5vj0hJqeTKsEEHbPDi4VdSSXxSsQ6lZM1byw0EHymimmm2fH1KfGLHbUcYXNMB0ijLLMij3ZiPrdFJkth0xlLF9Hhlj5Whpgcua1SQnw7UdNW0Gp2WqPU53Ryn185DM:'),
                        'User-Agent': 'ExecutivePresenceEbook/1.0'
                    }
                });
                
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
                
                const data = await response.json();
                console.log('Workflows:', data);
                
                if (data && data.data && data.data.length > 0) {
                    let html = '<h4>Your Workflows:</h4><div style="max-height: 300px; overflow-y: auto; border: 1px solid #ddd; padding: 10px; margin-top: 5px; background: white;">';
                    
                    data.data.forEach(workflow => {
                        html += `
                            <div style="padding: 8px; border-bottom: 1px solid #eee;">
                                <strong>${workflow.name || 'Unnamed Workflow'}</strong><br>
                                <small>ID: <code>${workflow.id}</code></small>
                            </div>`;
                    });
                    
                    // Add pagination info if available
                    if (data.meta) {
                        html += `
                            <div style="margin-top: 10px; padding-top: 10px; border-top: 1px solid #eee; font-size: 12px; color: #666;">
                                Page ${data.meta.page + 1} of ${data.meta.total_pages} • 
                                ${data.meta.total_items} total workflows
                            </div>`;
                    }
                    
                    html += '</div><p style="margin-top: 8px; font-size: 12px; color: #666;">Copy the Workflow ID to use in the Test Integration above.</p>';
                    testResult.innerHTML = html;
                    testResult.style.display = 'block';
                    testResult.style.background = '#e7f5fe';
                    resultDiv.textContent = `Found ${data.meta?.total_items || data.data.length} workflow(s)`;
                    resultDiv.style.display = 'block';
                } else {
                    resultDiv.textContent = 'No workflows found';
                    resultDiv.style.display = 'block';
                }
            } catch (error) {
                console.error('Error fetching workflows:', error);
                showMessage('testResult', `❌ Error fetching workflows: ${error.message}`, true);
            }
        });

        // Create Segment
        document.getElementById('createSegmentBtn').addEventListener('click', async function() {
            const resultDiv = document.getElementById('testResult');
            const segmentName = document.getElementById('segmentName').value.trim();
            const ruleField = document.getElementById('ruleField').value;
            const ruleOperator = document.getElementById('ruleOperator').value;
            const ruleValue = document.getElementById('ruleValue').value.trim();

            if (!segmentName || !ruleValue) {
                showMessage('testResult', '❌ Please fill in all fields', true);
                return;
            }


            try {
                showMessage('testResult', 'Creating segment...');
                
                const response = await fetch('https://api.flodesk.com/v1/segments', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'Authorization': 'Basic ' + btoa('fd_key_a5671a146595472fb913e1ef30126273.HLXll0SLiOy4OEnKoLQM6zujCjbxVlXpGWxcQHKUKC9ecFHBrE72BtMEYRa60MZvu5vj0hJqeTKsEEHbPDi4VdSSXxSsQ6lZM1byw0EHymimmm2fH1KfGLHbUcYXNMB0ijLLMij3ZiPrdFJkth0xlLF9Hhlj5Whpgcua1SQnw7UdNW0Gp2WqPU53Ryn185DM:'),
                        'User-Agent': 'ExecutivePresenceEbook/1.0'
                    },
                    body: JSON.stringify({
                        name: segmentName,
                        color: "5BC0EB", // Light blue color from your Flodesk account
                        rules: [{
                            field: ruleField,
                            operator: ruleOperator,
                            value: ruleValue
                        }]
                    })
                });

                const result = await response.json();
                
                if (response.ok) {
                    showMessage('testResult', `✅ Segment created successfully!\nID: ${result.id}\nName: ${result.name}`);
                    console.log('Segment created:', result);
                } else {
                    throw new Error(result.message || 'Failed to create segment');
                }
            } catch (error) {
                console.error('Error creating segment:', error);
                showMessage('testResult', `❌ Error creating segment: ${error.message}`, true);
            }
        });

        // Add or update subscriber and add to segment in a single request
        async function addToSegment(email, segmentId) {
            if (!segmentId) return { success: true, message: 'No segment ID provided' };
            
            const logs = [];
            const log = (message) => {
                console.log(`[${new Date().toISOString()}] ${message}`);
                logs.push(message);
                return message;
            };
            
            try {
                log(`Starting to add/update subscriber ${email} and add to segment ${segmentId}`);
                
                // First, ensure the subscriber exists
                log('Ensuring subscriber exists...');
                const subscriberData = {
                    email: email,
                    status: 'active',
                    first_name: 'Test',
                    last_name: 'User',
                    source: 'website',
                    custom_fields: {
                        'Signup Page': 'Executive Presence Ebook',
                        'Lead Source': 'Website'
                    },
                    optin_timestamp: new Date().toISOString()
                };
                
                log(`Subscriber data: ${JSON.stringify(subscriberData, null, 2)}`);
                
                // First, create/update the subscriber
                const createResponse = await fetch('https://api.flodesk.com/v1/subscribers', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'Authorization': 'Basic ' + btoa('fd_key_a5671a146595472fb913e1ef30126273.HLXll0SLiOy4OEnKoLQM6zujCjbxVlXpGWxcQHKUKC9ecFHBrE72BtMEYRa60MZvu5vj0hJqeTKsEEHbPDi4VdSSXxSsQ6lZM1byw0EHymimmm2fH1KfGLHbUcYXNMB0ijLLMij3ZiPrdFJkth0xlLF9Hhlj5Whpgcua1SQnw7UdNW0Gp2WqPU53Ryn185DM:'),
                        'User-Agent': 'ExecutivePresenceEbook/1.0'
                    },
                    body: JSON.stringify(subscriberData)
                });
                
                const createResult = await createResponse.json().catch(e => ({}));
                log(`Create/Update Status: ${createResponse.status} ${createResponse.statusText}`);
                log(`Create/Update Response: ${JSON.stringify(createResult, null, 2)}`);
                
                if (!createResponse.ok) {
                    throw new Error(`Failed to create/update subscriber: ${JSON.stringify(createResult)}`);
                }
                
                // Now add to segment using the correct Flodesk API endpoint
                log('Adding to segment...');
                const segmentData = {
                    email: email,
                    status: 'active'
                };
                
                log(`Segment URL: https://api.flodesk.com/v1/segments/${segmentId}/subscribers`);
                log(`Segment data: ${JSON.stringify(segmentData, null, 2)}`);
                
                const response = await fetch(`https://api.flodesk.com/v1/segments/${segmentId}/subscribers`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'Authorization': 'Basic ' + btoa('fd_key_a5671a146595472fb913e1ef30126273.HLXll0SLiOy4OEnKoLQM6zujCjbxVlXpGWxcQHKUKC9ecFHBrE72BtMEYRa60MZvu5vj0hJqeTKsEEHbPDi4VdSSXxSsQ6lZM1byw0EHymimmm2fH1KfGLHbUcYXNMB0ijLLMij3ZiPrdFJkth0xlLF9Hhlj5Whpgcua1SQnw7UdNW0Gp2WqPU53Ryn185DM:'),
                        'User-Agent': 'ExecutivePresenceEbook/1.0'
                    },
                    body: JSON.stringify(segmentData)
                });

                let result;
                try {
                    result = await response.json();
                } catch (e) {
                    result = { error: 'Failed to parse response', raw: await response.text() };
                }
                
                log(`API Status: ${response.status} ${response.statusText}`);
                log(`API Response: ${JSON.stringify(result, null, 2)}`);
                
                if (!response.ok) {
                    throw new Error(`Failed to create/update subscriber with segment: ${JSON.stringify(result)}`);
                }
                
                log('Successfully added to segment!');
                return { 
                    success: true,
                    segmentId: segmentId,
                    result: result,
                    logs: logs
                };
                
            } catch (error) {
                const errorMessage = error.message || 'Unknown error';
                log(`ERROR: ${errorMessage}`);
                console.error('Error in addToSegment:', error);
                return { 
                    success: false, 
                    error: errorMessage,
                    segmentId: segmentId,
                    logs: logs
                };
            }
        }

        // Alternative method to add to segment - uses a different API endpoint
        async function addToSegmentAlternative(email, segmentId) {
            const logs = [];
            const log = (message) => {
                console.log(`[${new Date().toISOString()}] [ALT] ${message}`);
                logs.push(`[ALT] ${message}`);
                return message;
            };
            
            try {
                log(`Trying alternative method to add ${email} to segment ${segmentId}`);
                
                // First, ensure the subscriber exists
                log('Ensuring subscriber exists...');
                const subscriberResponse = await fetch('https://api.flodesk.com/v1/subscribers', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'Authorization': 'Basic ' + btoa('fd_key_a5671a146595472fb913e1ef30126273.HLXll0SLiOy4OEnKoLQM6zujCjbxVlXpGWxcQHKUKC9ecFHBrE72BtMEYRa60MZvu5vj0hJqeTKsEEHbPDi4VdSSXxSsQ6lZM1byw0EHymimmm2fH1KfGLHbUcYXNMB0ijLLMij3ZiPrdFJkth0xlLF9Hhlj5Whpgcua1SQnw7UdNW0Gp2WqPU53Ryn185DM:'),
                        'User-Agent': 'ExecutivePresenceEbook/1.0'
                    },
                    body: JSON.stringify({
                        email: email,
                        firstName: 'Test',
                        status: 'active',
                        segments: [segmentId],  // Try adding segment directly in the subscriber update
                        custom_fields: {
                            'Signup Page': 'Executive Presence Ebook',
                            'Lead Source': 'Website'
                        }
                    })
                });
                
                const result = await subscriberResponse.json().catch(e => ({}));
                log(`Alternative method response: ${JSON.stringify(result, null, 2)}`);
                
                if (!subscriberResponse.ok) {
                    throw new Error(`Alternative method failed: ${JSON.stringify(result)}`);
                }
                
                // Check if segment was added in the response
                const segmentAdded = result.segments && result.segments.some(s => s.id === segmentId);
                
                return {
                    success: segmentAdded,
                    result: result,
                    logs: logs,
                    message: segmentAdded ? 'Added to segment via alternative method' : 'Segment not added in response'
                };
                
            } catch (error) {
                log(`Error in alternative method: ${error.message}`);
                return {
                    success: false,
                    error: error.message,
                    logs: logs
                };
            }
        }

        // Hardcoded Ebook segment ID
        const EBOOK_SEGMENT_ID = '684be75d6b21c78b38dfca5b';
        
        // Find the Ebook segment ID (kept for backward compatibility)
        async function findEbookSegmentId() {
            return EBOOK_SEGMENT_ID; // Always return the hardcoded ID
        }

        // Test Flodesk Integration with detailed logging
        document.getElementById('testFlodeskBtn').addEventListener('click', async function() {
            const resultDiv = document.getElementById('testResult');
            let segmentId = document.getElementById('segmentId').value.trim();
            const email = 'jazzjazpher5@gmail.com';
            
            // Clear previous results and show loading
            resultDiv.innerHTML = 'Starting test integration...<div id="testLogs" style="margin-top:10px;font-family:monospace;max-height:300px;overflow-y:auto;background:#f8f9fa;padding:10px;border-radius:4px;white-space:pre-wrap;"></div>';
            resultDiv.style.display = 'block';
            resultDiv.style.background = '#fff3cd';
            
            const logEl = document.getElementById('testLogs');
            const log = (message, isError = false) => {
                console.log(message);
                const timestamp = new Date().toLocaleTimeString();
                const logEntry = document.createElement('div');
                logEntry.style.color = isError ? '#dc3545' : '#0d6efd';
                logEntry.style.marginBottom = '4px';
                logEntry.textContent = `[${timestamp}] ${message}`;
                logEl.appendChild(logEntry);
                logEl.scrollTop = logEl.scrollHeight;
            };
            
            try {
                // Use the Ebook segment ID by default
                if (!segmentId) {
                    segmentId = EBOOK_SEGMENT_ID;
                    document.getElementById('segmentId').value = segmentId;
                    log(`Using Ebook segment ID: ${segmentId}`);
                } else {
                    log(`Using provided segment ID: ${segmentId}`);
                }
                
                // Skip subscriber creation and go straight to segment addition
                log('Skipping subscriber creation (test mode)');
                
                // Add to segment if segment ID is provided
                if (segmentId) {
                    log(`\nStep 1/2: Adding to segment ${segmentId}...`);
                    
                    // First verify the segment exists
                    log(`Verifying segment ${segmentId} exists...`);
                    let segmentExists = false;
                    try {
                        const verifyResponse = await fetch(`https://api.flodesk.com/v1/segments/${segmentId}`, {
                            headers: {
                                'Authorization': 'Basic ' + btoa('fd_key_a5671a146595472fb913e1ef30126273.HLXll0SLiOy4OEnKoLQM6zujCjbxVlXpGWxcQHKUKC9ecFHBrE72BtMEYRa60MZvu5vj0hJqeTKsEEHbPDi4VdSSXxSsQ6lZM1byw0EHymimmm2fH1KfGLHbUcYXNMB0ijLLMij3ZiPrdFJkth0xlLF9Hhlj5Whpgcua1SQnw7UdNW0Gp2WqPU53Ryn185DM:'),
                                'User-Agent': 'ExecutivePresenceEbook/1.0'
                            }
                        });
                        
                        segmentExists = verifyResponse.ok;
                        if (!segmentExists) {
                            log(`⚠️ Segment ${segmentId} not found or inaccessible. Status: ${verifyResponse.status}`);
                        } else {
                            const segmentData = await verifyResponse.json();
                            log(`✅ Found segment: "${segmentData.name}" (${segmentId})`);
                        }
                    } catch (e) {
                        log(`⚠️ Error verifying segment: ${e.message}`, true);
                    }
                    
                    // Try to add to segment
                    const segmentResult = await addToSegment(email, segmentId);
                    
                    // Log the segment addition result
                    if (segmentResult.logs) {
                        log('Segment API Logs:');
                        segmentResult.logs.forEach(msg => log(`  ${msg}`));
                    }
                    
                    if (!segmentResult.success) {
                        // If failed, try alternative method
                        log('Trying alternative method to add to segment...');
                        const altResult = await addToSegmentAlternative(email, segmentId);
                        
                        if (altResult.logs) {
                            altResult.logs.forEach(msg => log(`  ${msg}`));
                        }
                        
                        if (!altResult.success) {
                            throw new Error(`Failed to add to segment (tried 2 methods). Last error: ${altResult.error || 'Unknown error'}`);
                        }
                        log(`✅ Successfully added to segment using alternative method: ${segmentId}`);
                    } else {
                        log(`✅ Successfully added to segment: ${segmentId}`);
                    }
                }
                
                // Show final success message
                resultDiv.style.background = '#d4edda';
                log('\n✅ Test completed successfully!', false);
                
                // Show success message
                const successMessage = `
                    ✅ Test submitted successfully!<br>
                    Email: <strong>${email}</strong><br>
                    Added to segment: <strong>${segmentId} ✓</strong><br>
                    Time: <strong>${new Date().toLocaleString()}</strong><br>
                    Check your Flodesk dashboard for this test submission.`;
                
                const successDiv = document.createElement('div');
                successDiv.style.marginTop = '10px';
                successDiv.style.padding = '10px';
                successDiv.style.background = '#d4edda';
                successDiv.style.borderRadius = '4px';
                successDiv.style.color = '#155724';
                successDiv.innerHTML = successMessage;
                logEl.appendChild(successDiv);
                
            } catch (error) {
                console.error('Error in test integration:', error);
                log(`❌ ERROR: ${error.message || 'Unknown error occurred'}`, true);
                resultDiv.style.background = '#f8d7da';
                
                // Show error message
                let errorMessage = `
                    ❌ Test failed!<br>
                    Error: <strong>${error.message || 'Unknown error'}</strong><br>
                    Check the logs above for details.`;
                
                errorDiv.style.background = '#f8d7da';
                errorDiv.style.borderRadius = '4px';
                errorDiv.style.color = '#721c24';
                errorDiv.innerHTML = errorMessage;
                logEl.appendChild(errorDiv);
            }
        });
    </script>
    
    <!-- Back to Top Button -->
    <a href="#" class="back-to-top" aria-label="Back to top">
        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <path d="M18 15l-6-6-6 6"/>
        </svg>
    </a>

    <script>
        // Back to top button
        const backToTopButton = document.querySelector('.back-to-top');
        
        window.addEventListener('scroll', () => {
            if (window.pageYOffset > 300) {
                backToTopButton.classList.add('visible');
            } else {
                backToTopButton.classList.remove('visible');
            }
        });
        
        backToTopButton.addEventListener('click', (e) => {
            e.preventDefault();
            window.scrollTo({
                top: 0,
                behavior: 'smooth'
            });
        });
        
        // Add animation to elements when they come into view
        const animateOnScroll = () => {
            const elements = document.querySelectorAll('.chapter-card, .author-content, .form-container');
            
            elements.forEach(element => {
                const elementTop = element.getBoundingClientRect().top;
                const elementVisible = 150;
                
                if (elementTop < window.innerHeight - elementVisible) {
                    element.style.opacity = '1';
                    element.style.transform = 'translateY(0)';
                }
            });
        };
        
        // Set initial styles for animation
        document.addEventListener('DOMContentLoaded', () => {
            const elements = document.querySelectorAll('.chapter-card, .author-content, .form-container');
            elements.forEach(element => {
                element.style.opacity = '0';
                element.style.transform = 'translateY(20px)';
                element.style.transition = 'opacity 0.6s ease-out, transform 0.6s ease-out';
            });
            
            // Trigger initial check
            animateOnScroll();
        });
        
        window.addEventListener('scroll', animateOnScroll);
    </script>
</body>
</html>
